<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://xamarin.com/schemas/2014/forms"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:pv="clr-namespace:Xamarin.Forms.PancakeView;assembly=Xamarin.Forms.PancakeView"
             
             xmlns:sys="clr-namespace:System;assembly=mscorlib"
             x:Class="Elite_Soccer.Vistas.AdminPage"
             BackgroundColor="#111111"
             NavigationPage.HasNavigationBar="False">

    <ScrollView>
        <StackLayout Padding="15" Spacing="20">
            <!-- Encabezado -->
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="*"/>
                </Grid.ColumnDefinitions>

                <Image Source="volver.png"
           HeightRequest="30"
           WidthRequest="30"
           Grid.Column="0">
                    <Image.GestureRecognizers>
                        <TapGestureRecognizer Tapped="Volver_Clicked"/>
                    </Image.GestureRecognizers>
                </Image>

                <Label Text="Bienvenid@ Admin ⚽"
           FontSize="22"
           TextColor="Gold"
           FontAttributes="Bold"
           HorizontalOptions="Center"
           Grid.Column="1"/>
            </Grid>

            <!-- REGISTRAR PARTIDO -->
            <pv:PancakeView BackgroundColor="#1E1E1E" CornerRadius="15" Padding="15">
                <StackLayout Spacing="10">
                    <Label Text="Registrar Partido" FontSize="20" TextColor="Gold" HorizontalOptions="Center" />

                    <Picker x:Name="pickerCategoria" Title="Categoría" TitleColor="Gray" TextColor="White" SelectedIndexChanged="pickerCategoria_SelectedIndexChanged">
                        <Picker.Items>
                            <x:String>Varonil</x:String>
                            <x:String>Femenil</x:String>
                        </Picker.Items>
                    </Picker>

                    <Picker x:Name="pickerEquipoLocal" Title="Equipo Local" TitleColor="Gray" TextColor="White" />
                    <Picker x:Name="pickerEquipoVisitante" Title="Equipo Visitante" TitleColor="Gray" TextColor="White" />
                    <DatePicker x:Name="fechaPartido" TextColor="White" MinimumDate="{x:Static sys:DateTime.Today}" />
                    <TimePicker x:Name="horaPartido" TextColor="White" />

                    <Button Text="Registrar Partido" BackgroundColor="Gold" TextColor="Black" CornerRadius="20" Clicked="BtnRegistrarPartido_Clicked" />
                </StackLayout>
            </pv:PancakeView>

            <!-- PARTIDOS REGISTRADOS -->
            <pv:PancakeView BackgroundColor="#1E1E1E" CornerRadius="15"  Padding="10">
                <StackLayout>
                    <Label Text="Partidos Registrados" FontSize="18" TextColor="Gold" />
                    <ListView x:Name="listaPartidos" HasUnevenRows="True" BackgroundColor="Transparent" SeparatorColor="Gold" ItemSelected="ListaPartidos_ItemSelected">
                        <ListView.ItemTemplate>
                            <DataTemplate>
                                <TextCell Text="{Binding descripcion}" TextColor="White" DetailColor="Gray" />
                            </DataTemplate>
                        </ListView.ItemTemplate>
                    </ListView>
                </StackLayout>
            </pv:PancakeView>

            <!-- GOLEADORES -->
            <pv:PancakeView BackgroundColor="#1E1E1E" CornerRadius="15" Padding="15">
                <StackLayout Spacing="10">
                    <Label Text="Registrar Goleador" FontSize="20" TextColor="Gold" HorizontalOptions="Center" />
                    <Picker x:Name="pickerCategoriaG" Title="Categoría" TitleColor="Gray" TextColor="White" SelectedIndexChanged="pickerCategoriaG_SelectedIndexChanged">
                        <Picker.Items>
                            <x:String>Varonil</x:String>
                            <x:String>Femenil</x:String>
                        </Picker.Items>
                    </Picker>
                    <Picker x:Name="pickerEquipoG" Title="Equipo" TitleColor="Gray" TextColor="White" />
                    <Entry x:Name="txtNombreJugador" Placeholder="Nombre del jugador" TextColor="White" PlaceholderColor="WhiteSmoke" />
                    <Entry x:Name="txtGoles" Placeholder="Cantidad de goles" Keyboard="Numeric" TextColor="White" PlaceholderColor="WhiteSmoke" />
                    <Button Text="Guardar Goleador" BackgroundColor="Gold" TextColor="Black" CornerRadius="20" Clicked="BtnGuardarGoleador_Clicked" />
                    <Label Text="Tabla de Goleadores" FontSize="18" TextColor="Gold" />
                    <ListView x:Name="listaGoleadores" HasUnevenRows="True" BackgroundColor="Transparent" SeparatorColor="Gold" ItemTapped="ListaGoleadores_ItemTapped">
                        <ListView.ItemTemplate>
                            <DataTemplate>
                                <TextCell Text="{Binding descripcion}" TextColor="White" DetailColor="Gray" />
                            </DataTemplate>
                        </ListView.ItemTemplate>
                    </ListView>
                </StackLayout>
            </pv:PancakeView>

            <!-- TABLA DE POSICIONES -->
            <pv:PancakeView BackgroundColor="#1E1E1E" CornerRadius="15" Padding="15">
                <StackLayout Spacing="10">
                    <Label Text="Tabla de Posiciones" FontSize="20" TextColor="Gold" HorizontalOptions="Center" />

                    <Grid ColumnDefinitions="*,*">
                        <Button x:Name="btnTablaVaronil" Text="VARONIL" BackgroundColor="#252525" TextColor="Gold" CornerRadius="0" Clicked="BtnTablaCategoria_Clicked" />
                        <Button x:Name="btnTablaFemenil" Text="FEMENIL" Grid.Column="1" BackgroundColor="#1E1E1E" TextColor="White" CornerRadius="0" Clicked="BtnTablaCategoria_Clicked" />
                    </Grid>
                    <ScrollView Orientation="Horizontal">
                        <CollectionView x:Name="collectionTabla" SelectionMode="Single" SelectionChanged="CollectionTabla_SelectionChanged">
                            <CollectionView.Header>
                                <Grid ColumnDefinitions="40,*,50,50,50,50,50,50,60" BackgroundColor="#252525" Padding="10">
                                    <Label Text="#" Grid.Column="0" FontAttributes="Bold" TextColor="Gold" />
                                    <Label Text="EQUIPO" Grid.Column="1" FontAttributes="Bold" TextColor="Gold" />
                                    <Label Text="JJ" Grid.Column="2" FontAttributes="Bold" TextColor="Gold" />
                                    <Label Text="JG" Grid.Column="3" FontAttributes="Bold" TextColor="Gold" />
                                    <Label Text="JE" Grid.Column="4" FontAttributes="Bold" TextColor="Gold" />
                                    <Label Text="JP" Grid.Column="5" FontAttributes="Bold" TextColor="Gold" />
                                    <Label Text="GF" Grid.Column="6" FontAttributes="Bold" TextColor="Gold" />
                                    <Label Text="GC" Grid.Column="7" FontAttributes="Bold" TextColor="Gold" />
                                    <Label Text="PTS" Grid.Column="8" FontAttributes="Bold" TextColor="Gold" />
                                </Grid>
                            </CollectionView.Header>
                            <CollectionView.ItemTemplate>
                                <DataTemplate>
                                    <Grid ColumnDefinitions="40,*,50,50,50,50,50,50,60" Padding="10" BackgroundColor="#1E1E1E">
                                        <Label Text="{Binding Posicion}" Grid.Column="0" TextColor="White" />
                                        <Label Text="{Binding Equipo}" Grid.Column="1" TextColor="Gold" FontAttributes="Bold" />
                                        <Label Text="{Binding JJ}" Grid.Column="2" TextColor="White" />
                                        <Label Text="{Binding JG}" Grid.Column="3" TextColor="White" />
                                        <Label Text="{Binding JE}" Grid.Column="4" TextColor="White" />
                                        <Label Text="{Binding JP}" Grid.Column="5" TextColor="White" />
                                        <Label Text="{Binding GF}" Grid.Column="6" TextColor="White" />
                                        <Label Text="{Binding GC}" Grid.Column="7" TextColor="White" />
                                        <Label Text="{Binding PTS}" Grid.Column="8" TextColor="Gold" FontAttributes="Bold" />
                                    </Grid>
                                </DataTemplate>
                            </CollectionView.ItemTemplate>
                        </CollectionView>
                    </ScrollView>
                    <!-- Edición Rápida -->
                    <Label Text="Editar partido (APRETAR ALGUN EQUIPO DE ARRIBA EN LA TABLA)" TextColor="Gold" FontAttributes="Bold" />
                    <Grid ColumnDefinitions="*,*" Padding="10">
                        <Entry x:Name="entryEditarGF" Placeholder="GF" Keyboard="Numeric" TextColor="White" BackgroundColor="#333333" Grid.Column="0" />
                        <Entry x:Name="entryEditarGC" Placeholder="GC" Keyboard="Numeric" TextColor="White" BackgroundColor="#333333" Grid.Column="1" />
                    </Grid>

                    <Button Text="Guardar Cambios" BackgroundColor="#4CAF50" TextColor="White" CornerRadius="20" Clicked="BtnGuardarCambios_Clicked" />

                    <!-- Agregar Partido Manual -->
                    <Label Text="Agregar Partido" TextColor="Gold" FontAttributes="Bold" />
                    <Picker x:Name="pickerEquipoTabla" Title="Seleccionar equipo" TitleColor="Gray" TextColor="White" />

                    <Grid ColumnDefinitions="*,*" Padding="10">
                        <Entry x:Name="entryNuevoGF" Placeholder="GF" Keyboard="Numeric" TextColor="White" BackgroundColor="#333333" Grid.Column="0" />
                        <Entry x:Name="entryNuevoGC" Placeholder="GC" Keyboard="Numeric" TextColor="White" BackgroundColor="#333333" Grid.Column="1" />
                    </Grid>
                    <Button Text="Agregar Partido" BackgroundColor="Gold" TextColor="Black" CornerRadius="20" Clicked="BtnAgregarPartido_Clicked" />

                    <Button Text="Guardar Tabla en Firebase" x:Name="btnGuardarTabla" BackgroundColor="#4CAF50" TextColor="White" CornerRadius="25" Clicked="BtnGuardarTabla_Clicked" />
                </StackLayout>
            </pv:PancakeView>

            <!-- GESTIÓN DE JORNADAS -->
            <pv:PancakeView BackgroundColor="#1E1E1E" CornerRadius="15" Padding="15">
                <StackLayout Spacing="10">
                    <Label Text="Gestor de Jornadas" FontSize="20" TextColor="Gold" HorizontalOptions="Center" />

                    

                    <!-- Lista de jornadas -->
                    <CollectionView x:Name="collectionJornadas" SelectionMode="None">
                        <CollectionView.ItemTemplate>
                            <DataTemplate>
                                <Frame BackgroundColor="#2C2C2C" BorderColor="Gold" CornerRadius="10" Padding="10">
                                    <StackLayout>
                                        <Label Text="{Binding titulo}" FontAttributes="Bold" TextColor="Gold" />

                                        <CollectionView ItemsSource="{Binding PartidoJornada}" SelectionMode="None">
                                            <CollectionView.ItemTemplate>
                                                <DataTemplate>
                                                    <Grid ColumnDefinitions="*,Auto,Auto,Auto" Padding="5">
                                                        <Label Text="{Binding Local}" TextColor="White" />
                                                        <Entry Text="{Binding Visitante}" WidthRequest="40" Keyboard="Numeric" TextColor="White" Grid.Column="1" />
                                                        <Entry Text="{Binding GF_Local}" WidthRequest="40" Keyboard="Numeric" TextColor="White" Grid.Column="2" />
                                                        <Label Text="{Binding GF_Visitante}" TextColor="White" Grid.Column="3" />
                                                    </Grid>
                                                </DataTemplate>
                                            </CollectionView.ItemTemplate>
                                        </CollectionView>

                                    </StackLayout>
                                </Frame>
                            </DataTemplate>
                        </CollectionView.ItemTemplate>
                    </CollectionView>
                </StackLayout>
            </pv:PancakeView>


        </StackLayout>
    </ScrollView>
</ContentPage>
